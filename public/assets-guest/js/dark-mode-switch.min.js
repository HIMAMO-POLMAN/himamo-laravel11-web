const moon = document.querySelector('.btn-moon');
const sun = document.querySelector('.btn-sun');
const darkSwitch = document.getElementById("darkSwitch");
const table = document.querySelector('.table');

function updateIcons(isDark) {
    if (moon && sun) {
        moon.classList.toggle('d-none', isDark);
        sun.classList.toggle('d-none', !isDark);
    }
}

function applyTheme(isDark) {
    if (isDark) {
        document.body.setAttribute("data-theme", "dark");
        if (table) table.classList.add("table-dark");
    } else {
        document.body.removeAttribute("data-theme");
        if (table) table.classList.remove("table-dark");
    }
    updateIcons(isDark);
}

function initTheme() {
    const isDark = localStorage.getItem("darkSwitch") === "dark";
    if (darkSwitch) {
        darkSwitch.checked = isDark;
    }
    applyTheme(isDark);
}

function handleThemeChange() {
    const isDark = darkSwitch.checked;
    localStorage.setItem("darkSwitch", isDark ? "dark" : "light");
    applyTheme(isDark);
}

if (darkSwitch) {
    darkSwitch.addEventListener("change", handleThemeChange);
}

window.addEventListener("load", function() {
    initTheme();
    const user_button = document.querySelector('.bxs-user-circle');
    const settings_account = document.querySelector('.settings_account');

    if (user_button && settings_account) {
        user_button.addEventListener("click", function() {
            settings_account.classList.toggle('d-none');
        });
    }
});
